<h1>Secrets</h1>

<% @secrets.each do |secret| %>
    <%= secret.content%>
    <p><%= secret.likes.length %> likes</p>
    <% unless current_user.secrets_liked.include?(secret) %>
        <form action="/likes/<%= secret.id %>" method="post">
            <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">

            <input type="submit" value="Like" id="Like" name="Like"/>
        </form>
    <% else %>
        <form action="/likes/<%= secret.id %>" method="post">
            <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">

            <input type="hidden" name="_method" value="delete">
            <input type="submit" value="Unlike" id="Unlike" name="Unlike"/>
        </form>
    <% end %>
    <% if current_user == secret.user %>
    <form action="/secrets/<%= secret.id %>" method="post">
        <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">

        <input type="hidden" name="_method" value="delete">
        <input type="submit" value="Delete Secret" id="Delete Secret" name="Delete Secret"/>
    </form>
    <% end %>
<% end %>